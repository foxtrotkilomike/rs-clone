(()=>{"use strict";function e(e){window.localStorage.userName=e,document.querySelector("#user-name").textContent=e}const t=e=>{e.target instanceof HTMLElement&&!e.target?.closest(".popup__content")&&e.target.closest(".popup")?.classList.remove("is-open")},s=document.querySelector(".burger"),o=document.querySelector(".navbar__list"),r=[...document.querySelectorAll(".nav__link")];function n(){document.body.style.overflow="auto",document.body.style.userSelect="auto"}const a="https://rs-recipes-server.herokuapp.com";function c(e){window.localStorage.setItem("user",JSON.stringify(e))}async function i(e,t){return await fetch(`${a}${t}`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(Object.fromEntries(e.entries()))})}s.addEventListener("click",(()=>{s.classList.toggle("burger_open"),o.classList.toggle("navbar__list_open"),s.classList.contains("burger_open")?(document.body.style.overflow="hidden",document.body.style.userSelect="none"):n()})),r.forEach((e=>{e.addEventListener("click",(()=>{s.classList.remove("burger_open"),o.classList.remove("navbar__list_open"),n()}))})),document.querySelector("#user-name").textContent=window.localStorage.userName||"User",document.querySelector(".popup__body")?.addEventListener("click",t),function(){const e=document.querySelector(".profile-btn"),t=document.querySelector(".popup");e.addEventListener("click",(async()=>{if(localStorage.getItem("token")){const e=await fetch(`${a}/user/profile`,{credentials:"include"});200===e.status?(c(await e.json()),window.open("./user-page.html","_self")):t.classList.add("is-open")}else t.classList.add("is-open")}))}(),document.forms[1].addEventListener("submit",(async function(t){t.preventDefault();const s=t.target,o=function(e){if(e.password.value===e["password-confirm"].value)return e.querySelector("#password-mismatch").classList.add("hidden"),e.querySelector("#user-exist").classList.add("hidden"),new FormData(e);e.querySelector("#password-mismatch").classList.remove("hidden")}(t.target);if(void 0!==o){const t=await i(o,"/user/register");if(400===t.status)s.querySelector("#user-exist").classList.remove("hidden");else{document.querySelector(".popup").classList.remove("is-open"),alert("Registered successfully!"),localStorage.setItem("token","true"),s.reset();const o=await t.json();c(o),e(o.name)}}})),document.forms[0].addEventListener("submit",(async function(t){t.preventDefault();const s=t.target,o=(r=t.target,new FormData(r));var r;const n=await i(o,"/user/login");switch(n.status){case 401:s.querySelector("#wrong-password").classList.remove("hidden"),s.querySelector("#user-not-found").classList.add("hidden");break;case 404:case 500:s.querySelector("#user-not-found").classList.remove("hidden"),s.querySelector("#wrong-password").classList.add("hidden");break;case 200:{document.querySelector(".popup").classList.remove("is-open"),alert("Logged in successfully!"),localStorage.setItem("token","true"),s.reset();const t=await n.json();c(t),e(t.name)}}})),(e=>{const t=document.getElementById(e).querySelectorAll(".tabs-nav__item"),s=document.getElementById(e).querySelectorAll(".tabs-content__item");let o="";t.forEach((e=>e.addEventListener("click",(e=>r(e)))));const r=e=>{e.preventDefault(),t.forEach((e=>e.classList.remove("is-active")));const r=e.target.classList.contains("tabs-nav__item")?e.target:e.target.closest(".tabs-nav__item");var n;r?.classList.add("is-active"),s.forEach((e=>e.classList.remove("is-active"))),o=r?.getAttribute("data-tab-name"),n=o,s.forEach((e=>{e.getAttribute("data-tab-content")===n?e.classList.add("is-active"):e.classList.remove("is-active")}))}})("forms-container")})();
//# sourceMappingURL=about.bundle.js.map